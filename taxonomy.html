<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tag Input Field</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="tag-input-container" data-tags="apple,banana,orange"></div>
    <div class="tag-input-container" data-tags="dog,cat,rabbit"></div>
    <button id="copyTagsButton1">Copy Tags from Box 1</button>
    <button id="copyTagsButton2">Copy Tags from Box 2</button>
    <script src="script.js"></script>
</body>
</html>


<style>

body {
    font-family: Arial, sans-serif;
}

.tag-input-container {
    display: flex;
    flex-wrap: wrap;
    border: 1px solid #ccc;
    padding: 5px;
    width: 300px;
    margin-bottom: 10px;
}

.tag {
    display: flex;
    align-items: center;
    background-color: #e0e0e0;
    border-radius: 3px;
    padding: 3px 8px;
    margin: 2px;
}

.tag span {
    margin-right: 5px;
}

.tag .close-btn {
    cursor: pointer;
    font-size: 12px;
}

.tag-input {
    flex: 1;
    border: none;
    outline: none;
    min-width: 50px;
}


</style>


<script>

class TagInput {
    constructor(container) {
        this.container = container;
        this.tagInput = document.createElement('div');
        this.hiddenInput = document.createElement('input');
        this.tags = [];

        this.tagInput.classList.add('tag-input');
        this.tagInput.contentEditable = true;
        this.hiddenInput.type = 'hidden';
        this.hiddenInput.name = 'tags';
        this.container.appendChild(this.tagInput);
        this.container.appendChild(this.hiddenInput);

        this.init();
    }

    init() {
        const initialTags = this.container.getAttribute('data-tags');
        if (initialTags) {
            this.tags = initialTags.split(',').map(tag => tag.trim());
            this.tags.forEach(tag => this.addTag(tag));
        }

        this.tagInput.addEventListener('keydown', (e) => this.handleKeyDown(e));
        this.tagInput.addEventListener('paste', (e) => this.handlePaste(e));
        this.container.addEventListener('click', () => this.tagInput.focus());
    }

    handleKeyDown(e) {
        if (e.key === 'Enter' || e.key === ',') {
            e.preventDefault();
            const tagText = this.tagInput.innerText.trim().replace(/,$/, '');
            if (tagText && !this.tags.includes(tagText)) {
                this.tags.push(tagText);
                this.addTag(tagText);
                this.tagInput.innerText = '';
                this.updateHiddenInput();
            }
        } else if (e.key === 'Backspace' && this.tagInput.innerText === '') {
            const removedTag = this.tags.pop();
            if (removedTag) {
                const lastTagElement = this.container.querySelectorAll('.tag')[this.tags.length];
                this.container.removeChild(lastTagElement);
                this.updateHiddenInput();
            }
        }
    }

    handlePaste(e) {
        e.preventDefault();
        const paste = (e.clipboardData || window.clipboardData).getData('text');
        const pastedTags = paste.split(',').map(tag => tag.trim()).filter(tag => tag && !this.tags.includes(tag));
        pastedTags.forEach(tag => this.tags.push(tag));
        pastedTags.forEach(tag => this.addTag(tag));
        this.updateHiddenInput();
    }

    addTag(text) {
        const tagElement = document.createElement('div');
        tagElement.classList.add('tag');

        const tagText = document.createElement('span');
        tagText.innerText = text;

        const closeBtn = document.createElement('span');
        closeBtn.classList.add('close-btn');
        closeBtn.innerText = 'x';
        closeBtn.addEventListener('click', () => {
            this.container.removeChild(tagElement);
            this.tags = this.tags.filter(tag => tag !== text);
            this.updateHiddenInput();
        });

        tagElement.appendChild(tagText);
        tagElement.appendChild(closeBtn);
        this.container.insertBefore(tagElement, this.tagInput);
    }

    updateHiddenInput() {
        this.hiddenInput.value = this.tags.join(',');
    }

    copyTagsToClipboard() {
        const tagsString = this.tags.join(',');
        alert(tagsString)
        navigator.clipboard.writeText(tagsString).then(() => {
            alert('Tags copied to clipboard');
        }).catch(err => {
            console.error('Could not copy text: ', err);
        });
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const tagInputContainers = document.querySelectorAll('.tag-input-container');
    const tagInputs = Array.from(tagInputContainers).map(container => new TagInput(container));

    document.getElementById('copyTagsButton1').addEventListener('click', () => {
        tagInputs[0].copyTagsToClipboard();
    });

    document.getElementById('copyTagsButton2').addEventListener('click', () => {
        tagInputs[1].copyTagsToClipboard();
    });
});


</script>